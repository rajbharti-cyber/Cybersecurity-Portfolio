# ğŸ›¡ï¸ Case Study: Gray-Box Penetration Testing for El Banco Bank

This case study documents a **gray-box penetration test** performed for *El Banco Bank*, one of Europeâ€™s fastest-growing financial institutions managing â‚¬200 billion+ in assets.

The assessment included **network reconnaissance, aggressive scanning, and log analysis** to identify attacks and propose mitigation controls.

Source: El Banco Bank Problem Statement Document :contentReference[oaicite:1]{index=1}

---

# ğŸ“˜ 1. Project Overview

As a **Penetration Tester**, the goal was to simulate the actions of a real-world attacker and uncover weaknesses that could expose banking data.

The engagement included:

- Network scanning  
- Enumerating open ports  
- Identifying systems and services  
- Analyzing suspicious HTTP logs  
- Detecting attack types (XSS, Path Traversal, SQL Injection)  
- Recommending appropriate mitigation controls  

This reflects industry-standard gray-box pentesting methodologies.

---

# ğŸ¯ 2. Problem Statement

El Banco Bank processes millions of sensitive financial transactions daily.  
Due to a surge in cyber-attacks, the bankâ€™s security team requires:

- A rapid port scan to identify exposed services  
- Detailed system and version detection  
- Identification of incoming attacks via log analysis  
- Mitigation strategies to strengthen defenses  

---

# ğŸ§© 3. Scope of Work

### âœ” In Scope
- Half-open SYN scanning (fast, stealthy)  
- Aggressive Nmap scanning  
- HTTP log analysis  
- Attack identification  
- Mitigation recommendations  

### âœ– Out of Scope
- Exploitation of vulnerabilities  
- Social engineering  
- Internal privilege escalation  
- DDoS attacks  

---

# ğŸ› ï¸ 4. Tools & Techniques

- **Nmap** (SYN Scan, Aggressive Scan)  
- **HTTP Log Analysis**  
- Understanding of:
  - XSS  
  - Local File Inclusion (LFI) / Path Traversal  
  - SQL Injection  

---

# ğŸ§ª 5. Pentesting Tasks & Findings

---

# ğŸ”¹ **TASK 1: Half-Open (SYN) Scan**

**Goal:** Quickly identify open ports across target network.

### âœ” Command Used
```bash
nmap -sS <IP Range>
âœ” Outcome

Fast, stealthy scan detecting open TCP ports

Allowed identification of potentially vulnerable services

This forms the baseline for deeper enumeration.

ğŸ”¹ TASK 2: Aggressive Scan (OS, Version, Script, Traceroute)

Goal: Collect maximum information about targets.

âœ” Command Used
nmap -sS -A <IP Range>
âœ” Features Enabled

OS Detection

Version Enumeration

Script Scanning

Traceroute Mapping

âœ” Outcome

Aggressive scan revealed:

Operating systems

Active services

Running versions

Network paths

Potential misconfigurations

This helped identify attack surfaces and high-value targets.

ğŸ”¹ TASK 3: HTTP Log Analysis

Three suspicious logs were analyzed to identify attack types and mitigation strategies.

ğŸ“ Log 1 â€“ DOM-Based XSS Attempt
GET /media/system/js/caption.js HTTP/1.1
http://18.66.78.71/?wvstest=javascript:domxssExecutionSink(...)
âœ” Attack Identified

DOM-Based Cross-Site Scripting (XSS)
Payload injected into client-side JavaScript function.

âœ” Mitigation

Sanitize client-side input

Use safe JavaScript APIs

Implement Content Security Policy (CSP)

Encode output before rendering

ğŸ“ Log 2 â€“ Local File Inclusion (LFI) / Path Traversal
GET /DVWA/vulnerabilities/fi/?page=../../../../../../etc/passwd
âœ” Attack Identified

Path Traversal / Local File Inclusion (LFI)
Attacker tries to access the Linux /etc/passwd file.

âœ” Mitigation

Validate and whitelist file paths

Block directory traversal characters (../)

Disable dynamic file inclusion

Enforce least privilege on server files

ğŸ“ Log 3 â€“ SQL Injection Attempt
GET /DVWA/vulnerabilities/fi/?page='AND 1=cast(0x5f21403264696c656d6d61 as varchar(8000)) OR '1'='
âœ” Attack Identified

SQL Injection using logical operators and casting payload.

âœ” Mitigation

Use parameterized queries (prepared statements)

Implement strict server-side validation

Disable detailed SQL error messages

Apply web application firewall (WAF) rules

ğŸ“‰ 6. Risk Impact Summary
Attack Type	Severity	Impact
DOM XSS	High	Session theft, data manipulation
LFI / Path Traversal	Critical	File access, credential exposure
SQL Injection	Critical	Full DB compromise, authentication bypass

These attacks could lead to data breaches, financial fraud, and service outages.

ğŸ§­ 7. Recommendations
ğŸ”’ Strengthen Web Input Validation

Validate all inputs on server-side

Escape special characters

Implement global sanitization functions

ğŸ›¡ Harden Web Application Configurations

Restrict filesystem access

Disable unnecessary modules

Use WAF to block malicious patterns

ğŸ” Secure Database Access

Enforce least-privilege database roles

Switch to parameterized queries

Regularly perform vulnerability scans

ğŸ“Š Improve Monitoring & Detection

Enable anomaly-based monitoring

Block repeated suspicious IPs

Automate log analysis for early detection

ğŸ“¥ 8. Deliverables Provided

Half-open SYN scan command

Aggressive Nmap scan command

Attack identification for all 3 logs

Mitigation strategies for all threats

Consulting-level case study documentation

All content sourced from:
ğŸ“„ Capstone Project Problem Statement Document 

1641975470_capstoneproject4probâ€¦

ğŸ§¾ 9. Conclusion

The gray-box pentest revealed real-world attack attempts including XSS, Path Traversal, and SQL Injection.
By applying the recommended controls, El Banco Bank can significantly improve its defensive security posture.

This project demonstrates key penetration testing capabilities, including:

Reconnaissance

Enumeration

Threat detection

Log analysis

Defensive control mapping

ğŸ“¬ Contact

GitHub: https://github.com/rajbharti-cyber

LinkedIn: https://www.linkedin.com/in/rajbharti-cybersecurity/
